# Revenue Computation

This repository contains a Python application to compute various revenue metrics from a dataset of customer orders. The application reads data from a CSV file and calculates monthly revenue, product revenue, customer revenue, and identifies the top 10 customers by revenue. Additionally, the repository includes unit tests to verify the correctness of the computations.

## Project Structure

```
.
├── Dockerfile
├── Dockerfile.test
├── docker-compose.yml
├── main.py
├── orders.csv
├── requirements.txt
└── tests
    └── test_revenue_computation.py
```

### Files Description

- **Dockerfile**: Dockerfile to build the main application image.
- **Dockerfile.test**: Dockerfile to build the test image.
- **docker-compose.yml**: Docker Compose file to define the services.
- **main.py**: Main Python script containing the logic for computing revenue metrics.
- **orders.csv**: Sample dataset file containing customer orders.
- **requirements.txt**: List of Python dependencies.
- **tests/test_revenue_computation.py**: Test script containing unit tests for the application.

## Prerequisites

Make sure you have Docker and Docker Compose installed on your system.

## Setup

### Clone the Repository

```sh
git clone <repository-url>
cd <repository-directory>
```

### Install Dependencies (Optional)

If you prefer to run the application locally without Docker, you can set up a virtual environment and install dependencies:

```sh
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install -r requirements.txt
```

## Running the Application with Docker

1. **Build and Run the Application**

   ```sh
   docker-compose up app
   ```

   This command will build the Docker image for the main application and run it. The application will read data from `orders.csv` and compute the required revenue metrics.

2. **Output**

   The application will print the following to the console:
   - Monthly Revenue
   - Product Revenue
   - Customer Revenue
   - Top 10 Customers by Revenue

## Running the Tests with Docker

1. **Build and Run the Tests**

   ```sh
   docker-compose up test
   ```

   This command will build the Docker image for the tests and run them. The tests will verify the correctness of the revenue computation functions.

2. **Output**

   The test results will be printed to the console, showing the outcome of each test case.

## Docker Configuration

### `Dockerfile`

This Dockerfile builds the main application image:

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt requirements.txt
RUN pip install -r requirements.txt

COPY . .

CMD ["python", "main.py"]
```

### `Dockerfile.test`

This Dockerfile builds the test image:

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt requirements.txt
RUN pip install -r requirements.txt

COPY . .

CMD ["python", "-m", "unittest", "discover", "-s", "tests"]
```

### `docker-compose.yml`

This Docker Compose file defines the two services:

```yaml
version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - .:/app
    command: python main.py

  test:
    build:
      context: .
      dockerfile: Dockerfile.test
    volumes:
      - .:/app
    command: python -m unittest discover -s tests
```

## Explanation of the Code

### Main Script (`main.py`)

This script reads the data from `orders.csv` and computes various revenue metrics:

- **Monthly Revenue**: Total revenue generated by the online store for each month.
- **Product Revenue**: Total revenue generated by each product.
- **Customer Revenue**: Total revenue generated by each customer.
- **Top 10 Customers**: Identifies the top 10 customers by revenue generated.

### Test Script (`tests/test_revenue_computation.py`)

This script contains unit tests to verify the functionality of the main script:

- **Test Monthly Revenue**: Verifies the correctness of monthly revenue computation.
- **Test Product Revenue**: Verifies the correctness of product revenue computation.
- **Test Customer Revenue**: Verifies the correctness of customer revenue computation.
- **Test Top 10 Customers**: Verifies the correctness of identifying the top 10 customers by revenue.

## Conclusion

This setup provides a clean and isolated environment for running the main task and the tests, ensuring that the application functions correctly and can be easily maintained. Follow the instructions above to run the application and the tests using Docker.
